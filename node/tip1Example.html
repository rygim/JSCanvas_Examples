@(:title="Tip 1 Example")
@(:header="Tip 1 Example :  Which animation loop to optimize the user/development experience?")
<script type="text/javascript" src="/scripts/starfield.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        bindPresentationActions("/tip1.html", [], "/tip2.html");
    });
        
    window.onload = function(){
        var ctx = document.getElementById("starfield").getContext("2d");                 
        starfield.init(ctx, false, function(){ return 250;});
        ctx.strokeStyle = "black";
        ctx.beginPath();
        ctx.rect(0, 0, ctx.canvas.width, ctx.canvas.height);
        ctx.stroke();
        ctx.font = "40pt Arial";
        var text = "Animation loop demo";
        var dim = ctx.measureText(text);
        ctx.fillText(text, (ctx.canvas.width - dim.width) / 2, 250);
            
        ///          bad game loop
//           while(true){
//                starfield.update(ctx);
//               starfield.draw(ctx);
//           }
 
        ////          OK game loop
//                 var loop = function(){
//                     starfield.update(ctx);
//                       starfield.draw(ctx);
//                    setTimeout(loop, 10);
//                   };
//                 loop();

        ////            time normalized update loop
              var lastDrawTime = new Date().getTime();
              var drawLoop = function(){
                  var startDrawTime = new Date().getTime(); 
                  var elapsedTime = startDrawTime - lastDrawTime;
                  starfield.update(ctx, elapsedTime);
                  starfield.draw(ctx);
                  lastDrawTime = startDrawTime;
                  setTimeout(drawLoop, 5);
                };
                drawLoop();
    };
</script>

<canvas id="starfield" width="700" height="500" />    

